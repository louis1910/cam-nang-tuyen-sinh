<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- <meta charset="utf-8"> -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <meta name="viewport" content="width=device-width, intial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/responsive.css">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Tìm kiếm Văn bản</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/dataTables.bootstrap.min.css" rel="stylesheet">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    
  </head>
  <body>
    <div class="wrapper">
        <p>
            TÌM KIẾM VĂN BẢN
        </p>
    </div>
    
   <div class="bs-docs-section clearfix">
<div class="row">
<div class="col-lg-12">
<div class="bs-component" data-relatedvars="navbar-height,navbar-margin-bottom,navbar-border-radius,navbar-collapse-max-height,navbar-default-bg,navbar-default-border,navbar-default-brand-color,navbar-default-brand-hover-color,navbar-default-brand-hover-bg,navbar-default-color,navbar-default-link-color,navbar-default-link-hover-color,navbar-default-link-hover-bg,navbar-default-link-active-color,navbar-default-link-active-bg,navbar-default-link-disabled-color,navbar-default-link-disabled-bg,navbar-default-toggle-border-color,navbar-default-toggle-hover-bg,navbar-default-toggle-icon-bar-bg,navbar-default-link-active-bg,navbar-default-link-active-color">
<div class="navbar navbar-default">
<div class="navbar-header">
<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-inverse-collapse">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="index.html">Trang chủ</a>
</div>
<div class="navbar-collapse collapse navbar-inverse-collapse">
<ul class="nav navbar-nav">
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown">Ngành<b class="caret"></b></a>
<ul class="dropdown-menu" id="demo">
</ul>
 </li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
    
<div class="container">
        
        <!-- <input  type="search" class="form-control"
                style=" float: left; 
                       
                        margin-bottom: 10px;" 
                placeholder="Nhập dữ liệu muốn tìm ..." 
                id="search"/> 
        <button class="button" 
                style=" float: right;                        
                        height: 32px;
                        border-radius: 5px;
                        color: white;
                        font-weight: bold;
                        background-color: #bbbbbe;"
                id="btn">Tìm</button> -->
       
        <table class="table table-striped table-bordered table-hover table-res" >
            <thead>
                <tr>
                    <TH class="VB_THUOCTINH" style = "width: 20%"></TH>
                    <th class="VB_THONGTIN" >Thông tin văn bản</th>
                </tr>
            </thead>
            <tbody  id="mytable">                
            </tbody>


        </table>
        
        Các văn bản liên quan:
        <br>
        <br>
        <table class="table table-striped table-bordered table-hover table-res" id="mydata" >
            <thead>
                <tr>
                    <th class="VB_KYHIEU" >Ký hiệu</th>
                    <TH class="VB_NGAYKY" style = "width: 10%">Ngày ký</TH>
                    <TH class="VB_NGUOIKY">Người ký</TH>
                    <TH class="VB_TRICHYEU">Trích yếu</TH>
                    <TH class="CQBH_TENCQ">Cơ quan</TH>
                    <!-- <TH class="VB_NAMBH">Năm ban hành</TH> -->
                    <TH class="VB_TAPTIN">Tập tin</TH>
                    <TH class="VB_TAIVE"></TH>
                </tr>
            </thead>
            <tbody id="vblienquan">                
            </tbody>
        </table>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery1.dataTables.min.js"></script>
    <script src="js/dataTables.bootstrap.min.js"></script>

   <!--  
    <script>
    var nganh = '[ { "manganh": "YT", "tennganh": "Ngành Y tế", "tenfilejson": "data.json", "thumucvanban": "file" },{ "manganh": "GD", "tennganh": "Ngành Giáo dục", "tenfilejson": "nganhgiaoduc.json", "thumucvanban": "vanbangiaoduc"},{ "manganh": "TT", "tennganh": "Ngành Thể thao", "tenfilejson": "nganhthethao.json", "thumucvanban": "vanbanthethao" } ]';
    nganh = JSON.parse(nganh);
    for (var i = 0; i < nganh.length; i++) {
    	var li = document.createElement('li');
    	var createA = document.createElement('a');
    	var createAText = document.createTextNode(nganh[i].tennganh);
    	createA.setAttribute('href', "vanbantheonganh.html?tenfilejson="+nganh[i].tenfilejson +"&thumucvanban="+nganh[i].thumucvanban);
    	createA.appendChild(createAText);
    	li.appendChild(createA);        
    	demo.appendChild(li);
        }
   	</script>
 -->  	
 
 <script>
 var xmlhttp = new XMLHttpRequest();
 xmlhttp.onreadystatechange = function() 
  {
   if (this.readyState == 4 && this.status == 200) 
     {
        var nganh = JSON.parse(this.responseText);
        for (var i = 0; i < nganh.length; i++) 
        {
    	    var li = document.createElement('li');
    	    var createA = document.createElement('a');
    	    var createAText = document.createTextNode(nganh[i].tennganh);
    	    createA.setAttribute('href', "index.html?tenfilejson="+nganh[i].tenfilejson +"&thumucvanban="+nganh[i].thumucvanban);
    	    createA.appendChild(createAText);
    	    li.appendChild(createA);        
    	    demo.appendChild(li);
         }   
     }
   };
 xmlhttp.open("GET", "json/nganh.json", true);
 xmlhttp.send();
 </script>
 
 
 
 <script type="text/javascript">
   //var duongdan = parent.document.URL;
   var duongdan = decodeURIComponent(parent.document.URL);
   var n = duongdan.indexOf("?");
   if(n >= 0)
        	{
              var qparts = duongdan.split("?");
              var query = qparts[1];
              var vars = query.split("&");
              var value = "";
              var name =  "";
              for(var i = 0; i < vars.length; i++)
               {
	             var parts = vars[i].split("=");
                 name = parts[0];
                 value = parts[1];
                 localStorage.setItem(name,value);
                }
        	}
   else
            {
        	localStorage.setItem("tenfilejson", "data.json") ;
        	localStorage.setItem("thumucvanban", "file") ;
            }
 </script>
   	
  
   	
 <script>
         $(function () {
            var output;
            var hostname = location.hostname + "/van-ban-phap-luat";
             
                        output +="<tr>";
                        output +="<td class='VB_THUOCTINH'><b>"  +"Ký hiệu văn bản"+ "</b></td>";
                        output +="<td class='VB_THONGTIN'>"  +localStorage.getItem("kyhieu").toString()+ "</td>";
                        output +="</tr>"; 
                        
                        output +="<tr>";
                        output +="<td class='VB_THUOCTINH'><b>"  +"Ngày ký văn bản"+ "</b></td>";
                        output +="<td class='VB_THONGTIN'>"  +localStorage.getItem("ngayky").toString()+ "</td>";
                        output +="</tr>";
                        
                        output +="<tr>";
                        output +="<td class='VB_THUOCTINH'><b>"  +"Người ký"+ "</b></td>";
                        output +="<td class='VB_THONGTIN'>"  + localStorage.getItem("nguoiky")+ "</td>";
                        output +="</tr>";
                        
                        output +="<tr>";
                        output +="<td class='VB_THUOCTINH'><b>"  +"Trích yếu"+ "</b></td>";
                        output +="<td class='VB_THONGTIN'>"  +localStorage.getItem('trichyeu')+ "</td>";
                        output +="</tr>";
                        
                        output +="<tr>";
                        output +="<td class='VB_THUOCTINH'><b>"  +"Cơ quan ban hành"+ "</b></td>";
                        output +="<td class='VB_THONGTIN'>"  +localStorage.getItem("tencoquan")+ "</td>";
                        output +="</tr>";
                        
                        output +="<tr>";
                        output +="<td class='VB_THUOCTINH'><b>"  +"Năm ban hành"+ "</b></td>";
                        output +="<td class='VB_THONGTIN'>"  +localStorage.getItem("nambh")+ "</td>";
                        output +="</tr>";
                        
                        output +="<tr>";
                        output +="<td class='VB_THUOCTINH'><b>"  +"Tập tin văn bản"+ "</b></td>";
                        output +="<td class='VB_THONGTIN'><a href='http://docs.google.com/gview?url=" + hostname +"/" +localStorage.getItem("thumucvanban") + "/" + localStorage.getItem("taptin") +"' target='_blank' >"  +localStorage.getItem("taptin")+ "</a></td>";
                        output +="</tr>";
                        
                        output +="<tr>";
                        output +="<td class='VB_THUOCTINH'></td>";
                        output +="<td class='VB_THONGTIN'><a href='" + localStorage.getItem("thumucvanban") + "/" + localStorage.getItem("taptin") + "'  download  class='btn btn-primary' >"  +"Tải về"+ "</a> </td>";
                        output +="</tr>";
                        
                $('#mytable').html(output);
    })
    </script>
    
     
     <script>
         $(function () {
            var output;
            var hostname = location.hostname;
            var url = "json/" + localStorage.getItem("tenfilejson");
            var thumuc = localStorage.getItem("thumucvanban"); 
            var vanbanlienquan = "";
            //Tạo danh sách Văn bản liên quan
           var dsvanbanlienquan = new Array();
           //dsvanbanlienquan = ["54/2017/TT-BYT", "56/2017/TT-BYT", "52/2017/TT-BYT"];
            
           
           $.getJSON( url ,function(data){

        	      $.each(data, function(key, val){
        	        	if(val.VB_KYHIEU === localStorage.getItem("kyhieu")){
        	        			if(val.VB_LIENQUAN != null)
        	        			dsvanbanlienquan = val.VB_LIENQUAN;
        	        			//dsvanbanlienquan = localStorage.getItem("vblienquan"); // sai
        	               }
        	      });
           });
           
           
           
           
           $.getJSON( url ,function(data){  
                	if(dsvanbanlienquan.length > 0 ) {
                      $.each(data, function(key, val){
                    	for (var i = 0; i < dsvanbanlienquan.length; i++) {
                    		    vanbanlienquan = dsvanbanlienquan[i];
                        if(val.VB_KYHIEU === vanbanlienquan){
                        output +="<tr>";
                        output +="<td class='VB_KYHIEU' id='"+key+"'><a href='ThongTinVanBanChiTiet.html?kyhieu=" +val.VB_KYHIEU+ "&ngayky="+val.VB_NGAYKY+"&nguoiky="+ val.VB_NGUOIKY +"&trichyeu="+ val.VB_TRICHYEU 
                        		  +"&tencoquan="+ val.CQBH_TENCQ +"&taptin="+ val.VB_TAPTIN +"&nambh="+ val.VB_NAMBH +"&vblienquan="+ val.VB_LIENQUAN +"&thumucvanban="+localStorage.getItem("thumucvanban")+"&tenfilejson="+ localStorage.getItem("tenfilejson") +"'>"+val.VB_KYHIEU+"</a></td>";
                        output +="<td type='date' class='VB_NGAYKY' id='"+key+"'>" + val.VB_NGAYKY+"</td>";
                        output +="<td class='VB_NGUOIKY' id='"+key+"'>" + val.VB_NGUOIKY+"</td>";
                        output +="<td class='VB_TRICHYEU' id='"+key+"'>" + val.VB_TRICHYEU+"</td>";
                        output +="<td class='CQBH_TENCQ' id='"+key+"'>" + val.CQBH_TENCQ+"</td>";
                        output +="<td class='VB_TAPTIN' id='"+key+"'><a href='http://docs.google.com/gview?url=" + hostname +"/" +thumuc + "/" + val.VB_TAPTIN +"' target='_blank' >" +val.VB_TAPTIN+ "</a> </td>";
                        output +="<td class='VB_TAIVE' id='"+key+"'><a href='" + thumuc + "/" + val.VB_TAPTIN + "'  download  class='btn btn-primary' >"  +"Tải về"+ "</a> </td>";
                        output +="</tr>"  
                        }
                       }
                      });
                     }
                    	else {
                    		 output +="<tr>";
                    		 output +="<td>Không có hoặc chưa cập nhật văn bản liên quan</td>";
                    		 output +="</tr>" 
                    	}
 
                $('#vblienquan').html(output);
                $('#mydata').dataTable();
             });    
        	

            //------------------------------
        var btn = $("#btn");

        btn.click(function() {
             var search = $('#search').val();
        var regex = new RegExp(search, 'i');
        var output;
        
            // code mới
            
            // hết code
            
            
            $.getJSON(url ,function(data){

                $.each(data, function(key, val){
                    if(    (val.VB_KYHIEU.search(regex)!= -1) 
                        || (val.VB_NGUOIKY.search(regex) !=-1)
                        || (val.VB_NGAYKY.search(regex) !=-1)
                        || (val.VB_TRICHYEU.search(regex) !=-1)
                        || (val.CQBH_TENCQ.search(regex) !=-1)
                        //|| (val.VB_NAMBH.search(regex) !=-1)
                        || (val.VB_TAPTIN.search(regex) !=-1)

                        ){
                        output +="<tr>";
                        output +="<td class='VB_KYHIEU' id='"+key+"'>" + val.VB_KYHIEU+"</td>";
                        output +="<td type='date'  class='VB_NGAYKY' id='"+key+"'>" + val.VB_NGAYKY+"</td>";
                        output +="<td class='VB_NGUOIKY' id='"+key+"'>" + val.VB_NGUOIKY+"</td>";
                        output +="<td class='VB_TRICHYEU' id='"+key+"'>" + val.VB_TRICHYEU+"</td>";
                        output +="<td class='CQBH_TENCQ' id='"+key+"'>" + val.CQBH_TENCQ+"</td>";
                        output +="<td class='VB_TAPTIN' id='"+key+"'><a href='http://docs.google.com/gview?url=" + hostname +"/" +thumuc + "/" + val.VB_TAPTIN +"' target='_blank' >" +val.VB_TAPTIN+ "</a> </td>";
                        output +="<td class='VB_TAIVE' id='"+key+"'>" + "<a href=' "+ thumuc + "/" + val.VB_TAPTIN + "'  download class='btn btn-primary' >" +"Tải về"+ "</a>" + "</td>";
                        output +="</tr>"
                    }
                });
                $('#vblienquan').html(output);
                $('#mydata').dataTable();
            });
        

        });
    })
    
    </script>
    
    </div>
	<a href="https://docs.google.com/uc?export=download&id=1C0MmDtftdkD-wvValwe1F-qedvDa1_vD"><img src="images/android.png" width="15%" height="15%"></a>
	<br>
	
  </body>
</html>